<!-- src/app/app.component.html -->
<div class="app-container">
  <!-- Loading Spinner for Initial App Load -->
  <div class="app-loading" *ngIf="isInitializing">
    <div class="loading-overlay">
      <div class="loading-content">
        <div class="agrismart-logo">
          <i class="bi bi-leaf display-2 text-success"></i>
          <h2 class="text-success">AgriSmart</h2>
        </div>
        <div class="spinner-border text-success" role="status">
          <span class="visually-hidden">Cargando aplicación...</span>
        </div>
        <p class="text-muted mt-3">Inicializando sistema...</p>
      </div>
    </div>
  </div>

  <!-- Main Application Content -->
  <div class="app-content" *ngIf="!isInitializing">
    <!-- Router Outlet - This is where all your pages will be displayed -->
    <router-outlet></router-outlet>
  </div>

  <!-- Global Toast Notifications -->
  <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index: 1060;">
    <!-- Success Toast -->
    <div class="toast" id="successToast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="toast-header bg-success text-white">
        <i class="bi bi-check-circle-fill me-2"></i>
        <strong class="me-auto">Éxito</strong>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Cerrar"></button>
      </div>
      <div class="toast-body" id="successToastBody">
        <!-- Success message will be injected here -->
      </div>
    </div>

    <!-- Error Toast -->
    <div class="toast" id="errorToast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="toast-header bg-danger text-white">
        <i class="bi bi-exclamation-triangle-fill me-2"></i>
        <strong class="me-auto">Error</strong>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Cerrar"></button>
      </div>
      <div class="toast-body" id="errorToastBody">
        <!-- Error message will be injected here -->
      </div>
    </div>

    <!-- Warning Toast -->
    <div class="toast" id="warningToast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="toast-header bg-warning text-dark">
        <i class="bi bi-exclamation-triangle me-2"></i>
        <strong class="me-auto">Advertencia</strong>
        <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Cerrar"></button>
      </div>
      <div class="toast-body" id="warningToastBody">
        <!-- Warning message will be injected here -->
      </div>
    </div>

    <!-- Info Toast -->
    <div class="toast" id="infoToast" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="toast-header bg-info text-white">
        <i class="bi bi-info-circle-fill me-2"></i>
        <strong class="me-auto">Información</strong>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="toast" aria-label="Cerrar"></button>
      </div>
      <div class="toast-body" id="infoToastBody">
        <!-- Info message will be injected here -->
      </div>
    </div>
  </div>

  <!-- Connection Status Indicator -->
  <div class="connection-status" [ngClass]="getConnectionStatusClass()" *ngIf="showConnectionStatus">
    <div class="connection-indicator">
      <i class="bi" [ngClass]="getConnectionIcon()"></i>
      <span class="ms-2">{{ getConnectionStatusText() }}</span>
    </div>
  </div>

  <!-- Update Available Notification -->
  <div class="update-notification" *ngIf="updateAvailable">
    <div class="alert alert-info alert-dismissible fade show mb-0" role="alert">
      <i class="bi bi-download me-2"></i>
      <strong>Nueva versión disponible!</strong>
      Hay una actualización de AgriSmart lista para instalar.
      <button type="button" class="btn btn-sm btn-outline-info ms-2" (click)="installUpdate()">
        Actualizar ahora
      </button>
      <button type="button" class="btn-close" (click)="dismissUpdate()" aria-label="Cerrar"></button>
    </div>
  </div>

  <!-- Global Progress Bar -->
  <div class="global-progress" *ngIf="showGlobalProgress">
    <div class="progress-bar bg-success" 
         [style.width.%]="globalProgressValue"
         role="progressbar"
         [attr.aria-valuenow]="globalProgressValue"
         aria-valuemin="0"
         aria-valuemax="100">
    </div>
  </div>

  <!-- Keyboard Shortcuts Help Modal -->
  <div class="modal fade" id="shortcutsModal" tabindex="-1" aria-labelledby="shortcutsModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="shortcutsModalLabel">
            <i class="bi bi-keyboard me-2"></i>Atajos de Teclado
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <div class="row">
            <div class="col-md-6">
              <h6>Navegación</h6>
              <div class="keyboard-shortcut">
                <kbd>Ctrl</kbd> + <kbd>D</kbd>
                <span>Dashboard</span>
              </div>
              <div class="keyboard-shortcut">
                <kbd>Ctrl</kbd> + <kbd>C</kbd>
                <span>Empresas</span>
              </div>
              <div class="keyboard-shortcut">
                <kbd>Ctrl</kbd> + <kbd>F</kbd>
                <span>Fincas</span>
              </div>
              <div class="keyboard-shortcut">
                <kbd>Ctrl</kbd> + <kbd>P</kbd>
                <span>Producciones</span>
              </div>
            </div>
            <div class="col-md-6">
              <h6>Acciones</h6>
              <div class="keyboard-shortcut">
                <kbd>Ctrl</kbd> + <kbd>N</kbd>
                <span>Nuevo registro</span>
              </div>
              <div class="keyboard-shortcut">
                <kbd>Ctrl</kbd> + <kbd>S</kbd>
                <span>Guardar</span>
              </div>
              <div class="keyboard-shortcut">
                <kbd>Ctrl</kbd> + <kbd>Q</kbd>
                <span>Busqueda rápida</span>
              </div>
              <div class="keyboard-shortcut">
                <kbd>?</kbd>
                <span>Mostrar ayuda</span>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- PWA Install Prompt -->
  <div class="pwa-install-prompt" *ngIf="showPwaPrompt">
    <div class="alert alert-success alert-dismissible fade show mb-0" role="alert">
      <i class="bi bi-phone me-2"></i>
      <strong>Instalar AgriSmart</strong>
      Instala la aplicación en tu dispositivo para un acceso más rápido.
      <button type="button" class="btn btn-sm btn-outline-success ms-2" (click)="installPwa()">
        Instalar
      </button>
      <button type="button" class="btn-close" (click)="dismissPwaPrompt()" aria-label="Cerrar"></button>
    </div>
  </div>
</div>